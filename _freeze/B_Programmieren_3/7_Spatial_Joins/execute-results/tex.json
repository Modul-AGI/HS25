{
  "hash": "d7daa6ea98fc17422f868cdae8c831ea",
  "result": {
    "engine": "jupyter",
    "markdown": "# Spatial Joins {#sec-spatialjoin}\n\nIn dieser Aufgabe wollen wir für jeden Zeckenstich ermitteln, ob er sich im Wald befindet oder nicht. Den Wald Layer kennt ihr bereits aus dem Block \"Datenqualität und Unsicherheit\" und wir haben ihn in @sec-pythongis-formate kurz angeschaut. Nutzen wir hier nochmal die Gelegenheit, um den Wald und die Zeckenstiche (siehe @tbl-datensaetze) als Geodaten einzulesen und in einer grossem Plot zu visualisieren.\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport geopandas as gpd\n\nzeckenstiche_gpd = gpd.read_file(\"data/zeckenstiche.gpkg\")\nwald = gpd.read_file(\"data/wald.gpkg\")\n\nminx, miny, maxx, maxy = zeckenstiche_gpd.geometry.total_bounds  # holt die x und y min bzw. max werte und speichert diese in 4 variabeln\n\nfrom matplotlib.colors import ListedColormap\n\nbase = wald.plot(column = \"Wald_text\", legend = True, cmap = ListedColormap([\"green\",\"lightgrey\"]))\nzeckenstiche_gpd.plot(color = \"Red\", ax = base)\n\nbase.set_xlim(minx - 10, maxx + 10) \nbase.set_ylim(miny - 5, maxy + 5)\n```\n\n::: {.cell-output .cell-output-error}\n```\nModuleNotFoundError: No module named 'geopandas'\n```\n:::\n:::\n\n\n## Wie funktioniert ein *Spatial Join*?\n\nIn @sec-pythongis habt ihr euch mit den GIS-Funktionalitäten von `geopandas` vertraut gemacht. Eine ganz zentrale Funktion in GIS sind die sogenannten \"Spatial Joins\". Dabei werden Attribute von einem Geodatensatz auf einen anderen Geodatensatz aufgrund einer räumlichen Beziehung der beiden Datensätze übertragen. Konkret auf unsere Zeckenstiche bedeutet dies: Jedem Zeckenstich sollte die Eigenschaft \"Wald: ja\" / \"Wald: nein\" aus `wald zugewiesen werden. Am einfachsten lässt sich dies in einer Darstellung erklären:\n\n![\"Spatial Join\" zwischen `zeckenstiche` und `wald`. In diesem Spatial Join wurde die Geometrie von `zeckenstiche` übernommen, das heisst das Resultat des Joins ist ein Punkt-Layer.](figures/spatialjoin.jpg){#fig-spatialjoin}\n\nIn Python wird ein *Spatial Join* zwischen `zeckenstiche` und `wald` wie folgt durchgeführt (wichtig ist dabei auch die Reihenfolge der Argumente: `left_df` bestimmt den Geometrietyp des Outputs):\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\ngpd.sjoin(left_df = zeckenstiche_gpd, right_df = wald)\n```\n\n::: {.cell-output .cell-output-error}\n```\nNameError: name 'gpd' is not defined\n```\n:::\n:::\n\n\n",
    "supporting": [
      "7_Spatial_Joins_files/figure-pdf"
    ],
    "filters": []
  }
}